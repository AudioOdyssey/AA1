{% extends "template.html" %}
{% block content %}
<script src="{{ url_for('static', filename='js/story/run.js') }}"></script>
<!--NONE OF THIS NEEDS TO BE SAVABLE PER MIGUEL basically just a text version of the app but doesnt
need to be nearly as clean/advanced. Do we want to make this like treeview where it replaces itself?-->

<a href="/story/run?story_id={{story.story_id}}" class="btn btn-light">Back to Start</a>
<a href="/story/update?story_id={{story.story_id}}" class="btn btn-light">Back to Main Story Page</a>
<a class="btn btn-primary" style="float:right"
    href="/story/location/indiv?story_id={{story.story_id}}&location_id={{location.location_id}}">Edit Location</a>

<h1>Running {{story.story_title|e}}</h1>
<br>
<h3>Inventory:</h3>
{%for itm in inv%}
<div style="margin:0.5rem; border: solid grey 1px; padding: 0.25rem; background: white">{{itm.obj_name|e}}</div>
{%else%}
<div style="margin:0.5rem; border: solid grey 1px; padding: 0.25rem; background: white">Nothing!</div>
{%endfor%}

<h2>At {{location.location_name|e}}</h2>

<hr>
<h3>{{location.original_description|e}}</h3>
<!--I think printing 
    all of these is acceptable maybe we could hide the not relevant ones if we can track the info?-->
<p>(if already visited: {{location.short_description|e}})</p>
{% if location.location_event_id|int!=0 %}
<p>(if {{location.event_name|e}} has been triggered:{{location.post_event_description|e}} )</p>
{%endif%}
<hr>
<!--for objects at this location (brian idk how to keep track of that)-->
<!--print their names and have a pick up option-->
{%for obj in objects%}
<a onclick="addItem({{obj.obj_id}})" class="btn btn-light" {%if not obj.can_pickup_obj%}disabled{%endif%}>Pick Up <i>{{obj.obj_name}}</i></a>
{%endfor%}
<p>Would you like to ...</p>

<section class="row">
    {%for dec in decisions%}
    <a {%if dec.transition%}href="/story/run?story_id={{story.story_id}}&location_id={{dec.transition_loc_id}}"
        {%endif%} class="col-sm-4 storycard">
        <h3>{{dec.decision_name|e}}</h3>
        <hr>
        <h5>Transitions to
            <i>{%if dec.transition%}{{StoryLocation.get(story.story_id, dec.transition_loc_id).location_name}}{%else%}Nowhere{%endif%}</i>
        </h5>
        <p>{{dec.decision_description|e}}</p>
    </a>
    {%endfor%}
</section>

<!--
if transition
    Transitions to transitionid
    click: push back to cookie
    click: transition to transitionid
if hidden
    if hideobj != 0
        if hideobj not in inv
            Hidden by object hideobj
    if hideevt != 0
        if hideevt not in evts
            Hidden by event hideevt
if locked
    if lockobj != 0
        if lockobj not in inv
            Locked by object lockobj
    if lockevt != 0
        if lockevt not in evts
            Locked by event lockevt
if triggers
    Triggers Event triggerevt
    click: triggerevt
if locker != 0
    if locker in cookie
        Locked by Event locker
if once
    if dec not in cookie
        Can be triggered once
        click: add to cookie
    else
        Has been triggered, can't be again
-->

<br>
<hr>

<a href="/story/run?story_id={{story.story_id}}" class="btn btn-light">Back to Start</a>
<a href="/story/update?story_id={{story.story_id}}" class="btn btn-light">Back to Main Story Page</a>
<a class="btn btn-primary" style="float:right"
    href="/story/location/indiv?story_id={{story.story_id}}&location_id={{location.location_id}}">Edit Location</a>

{% endblock %}