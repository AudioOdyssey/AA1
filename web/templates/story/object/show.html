{% extends "template.html" %}
{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/story/object/show.css') }}" type="text/css"/>
<script src="{{ url_for('static', filename='js/story/object/show.js') }}"></script>

       
        <a href = "#bottom"><button class= "btn btn-light">Bottom of Page</button></a>
         <a href = "/story/update"><button class = "btn btn-light">Back to Main Story Page</button></a>
         <a href = "/story/location/show"><button class = "btn btn-light">Edit Locations</button></a>
         <a href = "/story/event/show"><button class = "btn btn-light">Edit Events</button></a>

<section class="row">
    <h3>Objects</h3>
  <button type="button" onclick="add_btn_pressed('{{ story_id }}')" id="add-btn" class="btn btn-light"><i class="fas fa-plus"></i></button>
</section>

<!--<input id= "testchk"  type= "checkbox" onclick= "show_test()">
<h1 class="test" >Invisible</h1>
<h2 class=test>Invisible</h2> SUGGEST LOOP ERROR WHEN PULLING IDS-->

<form id="obj-template" onclick="set_focus(this)" method="POST" action="/story/object/update">
    <input name="story_id" readonly class="hidden-in">
    <input name="obj_id" readonly class="hidden-in">

    <button type= "button" onclick= "delete_btn_pressed(this)" class="trash btn btn-light"><i class="fa fa-minus"></i></button>

    <section class="object-row row">
        <section class="row flex-1">

            <div class="col-sm-4">
                <label for= "obj_name"><b>Name:</b></label>
                <input id = "obj_name" class="form-control" type="text" onchange="object_changed(this)" name="obj_name" required>
            </div>

            <div class="col-sm-8">
                <label for = "starting_loc"><b>Select Starting Location: or <a href = "/story/location/show"> Add New Location</a></b></label>
                <select id = "starting_loc" class="form-control" type="text" onchange="object_changed(this)" name="obj_starting_loc">
                        {% for locations in location %}
                        <option>{{location.location_name}}</option>
                    {% endfor %}
                </select>
            </div>

        </section>

        <section class="flex-0" onclick="object_show(this)">
            <i class="fas fa-chevron-down fa-lg down-arrow"></i>
        </section>

    </section>

    <section class="row details" style="display: none">
        <hr>
        <label for = "obj_desc">Description</label>
        <textarea class="form-control" rows="3" onchange="object_changed(this)" name="obj_description"></textarea>
        <br>

        <label>Is Hidden? </label>
        <input type="checkbox" id= "chk1" autocomplete="off" onclick= "show_event()" onchange="object_changed(this)" name="is_hidden" >

           <!---should only display if "is hidden" is checked  @brian-->
        <div class= "hidden">
        <label class="hidden">Select Unhide Event Name: or <a href = "/story/event/show"> Add New Event</a></label>
        <select class="hidden" onchange="object_changed(this)" name="unhide_event_ID">
                {% for events in event %}
                    <option>{{event.event_name}}</option>
                {% endfor %}
        </select>   
        </div>
    </section>
</form> 

<div id="content-marker"></div>

{% for object in objects %}
<form class="object-main-row" onclick="set_focus(this)" method="POST" action="/story/object/update">
    <input name="story_id" value="{{ object.story_id }}" readonly class="hidden-in">
    <input name="obj_id" value="{{ object.obj_id }}" readonly class="hidden-in">

    <button type="button" onclick= "delete_btn_pressed(this)"  class="trash"><i class= "fa fa-minus"></i></button>

    <section class="object-row row">
        <section class="row flex-1">
            <div class="col-sm-4">
                <label><b>Name:</b></label>
                <input class="form-control" type="text" name="obj_name" onchange="object_changed(this)" value="{{ object.obj_name }}" required>
            </div>
            <div class="col-sm-8">
            <label><b>Select Starting Location: or <a href = "/story/location/show"> Add New Location</a></b></label>
            <select class="form-control" type="text" name="obj_starting_loc" onchange="object_changed(this)" value="{{ object.obj_location}}">
                    {%for locations in location%}
                        <option>{{location.location_name}}</option>
                    {%endfor%}
            </select>
            </div>
        </section>

             <section class="flex-0" onclick="object_show(this)">
                <i class="fas fa-chevron-down fa-lg down-arrow"></i>
            </section>

    </section>
    <section class="row details" style="display: none">
        <hr>

        <label>Description</label>
        <textarea class="form-control" rows="3" name="obj_description" onchange="object_changed(this)">{{ object.obj_description }}</textarea>
        <br>

        <label>Is Hidden? </label>
        {%if object.is_hidden%}
        <input  id = "chk1" type="checkbox" name= "is_hidden" autocomplete="off"  onclick="show_event()" onchange="object_changed(this)" checked>
        {%else%}
        <input  id= "chk2" type="checkbox" name= "is_hidden" autocomplete="off"  onclick="show_event()" onchange="object_changed(this)" >
        {%endif%}
         <!---should only display if "is hidden" is checked  @brian-->
        <div class= "hidden">
        <br>
        <label class="hidden">Select Unhide Event Name: or <a href = "/story/event/show"> Add New Event</a></label>
            <select class= "form-control hidden"  type="text" name="obj_unhide_event" onchange="object_changed(this)" value="{{ object.unhide_event_id}}">
                    {%for events in event%}
                        <option>{{event.event_name}}</option>
                    {%endfor%}
            </select>
        </div>
    </section>
</form>
{% endfor %}
<br>
<a href = "#add-btn"><button id = "bottom" class = "btn btn-light">Back to Top</button></a>
{% endblock %}