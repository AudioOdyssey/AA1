{% extends "template.html" %}
{% block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/story/location/decision/show.css') }}" type="text/css"/>
<script src="{{ url_for('static', filename='js/story/location/decision/show.js') }}"></script>

        <a href = "/story/update"><button class = "btn btn-light">Back to Main Story Page</button></a>
        <a href = "#bottom"><button class= "btn btn-light">Bottom of Page</button></a>

<section class="row">
    <h3>Decisions</h3>
    <hr>
    <h3>Location Name: '{{location_name}}'</h3>
    
    <button type="button" onclick="add_btn_pressed('{{ story_id }}', '{{ location_id }}')" id="add-btn" class="btn btn-light"><i class="fas fa-plus"></i></button>
</section>

<form id="dec-template" onclick="set_focus(this)" method="POST" action="/story/location/decision/update">
    <input name="story_id" readonly class="hidden-in">
    <input name="location_id" readonly class = "hidden-in">
    <input name="decision_id" readonly class="hidden-in">

    <button type= "button" onclick= "delete_btn_pressed('{{story_id , location_id, decision_id}}')" class="trash"><i class="fa fa-minus"></i></button>

    <section class="decision-row row">
        <section class="row flex-1">
            <div class="col-sm-4">
                <label for="dec_name"><b>Name:</b></label>
                 <input id = "dec_name" class="form-control" type="text" name="decision-name" onchange="decision_changed(this)">
            </div>

            <div class="col-sm-8">
                <label><b>Properties</b></label>
                    <p id = "prop" class="form-control"> Not Hidden, Not Transtion, Not Locked</p>
            </div>
        </section>

        <section class="flex-0" onclick="decision_show(this)">
            <i class="fas fa-chevron-down fa-lg down-arrow"></i>
        </section>
    </section>

    <section class="row details" style="display: none">

        <!---add max and min value--> 
        <label for="dec_num">Decision Sequence Number:</label> 
         <input id= "dec_num" class="form-control" type= "number" min= "1" name="sequence_number" onchange="decision_changed(this)">
        <hr>
        <label for = "dec_desc">Decision Description:</label>
         <textarea id = "dec_desc" class="form-control" rows="3" name="dec_description" onchange="decision_changed(this)"></textarea>
        <hr>

       <label for = "trans">Causes a transition?</label>
        <input id ="trans" type="checkbox" autocomplete="off" name="transition" onchange="decision_changed(this)">
        <br>
         <!---should only display if "trans" is checked @brian--> 
       <label for = "trans_loc">Select Transition Location: or <a href = "/story/location/show"> Add New Location</a></label>
        <select id = "trans_loc" class="form-control" type="text" autocomplete="off" name="transition_loc_id" onchange="decision_changed(this)">
                    {% for locations in location %}
                        <option>{{location.location_name}}</option>
                    {%endfor%}
        </select>

        <hr>
        <label for = "once">Can occur only ONCE?</label>
         <input id = "once" type="checkbox" autocomplete="off" name="can_occur_once" onchange="decision_changed(this)">
        <hr>

        <label for = "hid">Is Hidden?</label>
         <input id = "hid"type="checkbox" autocomplete="off" name="hidden" onchange="decision_changed(this)">
        <br>
        <section class = "row flex-1">
            <div class = "col-sm-6">
          <!---should only display if "hid" is checked @brian--> 
        <label for = "show_event">Select Event to show decision: or <a href = "/story/event/show"> Add New Event</a></label>
        <select id = "show_event" class="form-control" type="text" autocomplete="off" name="show_event_id" onchange="decision_changed(this)">
                {%for events in event%}
                    <option>{{event.event_name}}</option>
                {%endfor%}
        </select> 
        </div>
        <div class = "col-sm-6">
         <!---should only display if "hid" is checked @brian--> 
         <label for = "show_obj">Select Object to show decision: or <a href = "/story/object/show"> Add New Object</a></label>
        <select id= "show_obj" class="form-control" type="text" autocomplete="off" name="show_object_id" onchange="decision_changed(this)">
                {%for objects in object%}
                <option>{{object.obj_name}}</option>
                {%endfor%}
        </select>      
        </div>
</section>
<hr>
        <label for = "locked">Is Locked?</label>
         <input id = "locked" type="checkbox" autocomplete="off" name="locked" onchange="decision_changed(this)">
        <br>
    <section class = "row flex-1">
        <div class = "col-sm-6">
         <!---should only display if "locked" is checked @brian--> 
        <label for = "unlock_obj">Select Object to unlock decision: or <a href = "/story/object/show"> Add New Object</a></label>
        <select class="form-control" type="text" autocomplete="off" name="unlock_event_id" onchange="decision_changed(this)">
                {%for objects in object%}
                <option>{{object.obj_name}}</option>
                {%endfor%}
        </select>
         <!---should only display if "locked" is checked (and object is selected?) @brian--> 
        <label>Description when locked (NOT by an event):</label>
        <textarea class="form-control" autocomplete="off" name="locked_descr" onchange="decision_changed(this)"></textarea>
        </div>
        <div class = "col-sm-6">
        <!---should only display if "locked" is checked @brian--> 
         <label for = "unlock_event">Select Event to unlock decision: or <a href = "/story/event/show"> Add New Event</a></label>
        <select id = "unlock_event" class="form-control" type="text" autocomplete="off" name="unlock_event_id" onchange="decision_changed(this)">
                {%for events in event%}
                <option>{{event.event_name}}</option>
                {%endfor%}
        </select>
       
         <!---should only display if "locked" is checked (and when event is selected?) @brian-->
        <label for = "locked_ev_desc">Description when locked by event:</label>
        <textarea id = "locked_ev_desc" class="form-control" autocomplete="off" name="locked_descr" onchange="decision_changed(this)"></textarea>
      </div>
    </section>   
      
      <hr>

        <label for = "afer">Description of decision aftermath:</label>
        <textarea id = "after" class="form-control" name="aftermath_desc" autocomplete="off" onchange="decision_changed(this)"></textarea>
        <hr>
        <label for = "trigger">Does this decision trigger an event?</label>
        <input id = "trigger" type="checkbox" autocomplete="off" onchange="decision_changed(this)" name="cause_event">
        <br>

         <!---should only display if "trigger" is checked @brian-->
        <label for = "trig_ev">Select Event triggered by this decision: or <a href = "/story/event/show"> Add New Event</a></label>
        <select id = "trig_ev" class="form-control" type="text" autocomplete="off" name="effect_event_id" onchange="decision_changed(this)">
                {%for events in event%}
                <option>{{event.event_name}}</option>
                {%endfor%}
        </select>
    
    </section>
</form>

<div id="content-marker"></div>

{% for decision in decisions %}
<form class="decision-main-row" onclick="set_focus(this)" method="POST" action="/story/location/decision/update">
    <input name="story_id" value="{{ decision.story_id }}" readonly class="hidden-in">
    <input name="location_id" value="{{ decision.loc_id}}" readonly class = "hidden-in">
    <input name="decision_id" value="{{ decision.decision_id }}" readonly class="hidden-in">

    <button type= "button" onclick= "delete_btn_pressed('{{story_id , decision_id}}')" class="trash"><i class="fa fa-minus"></i></button>

    <section class="decision-row row">
        <section class="row flex-1">
            <div class="col-sm-4">
                <label><b>Name:</b></label>
                <input class="form-control" type="text" name="decision-name" onchange="decision_changed(this)" value="{{ decision.decision_name }}">
            </div>
            <hr>
            <div class="col-sm-8">
                <label><b>Properties:</b></label>
                <br>
                <p class="form-control">
                    {%if decision.hidden%}
                    Hidden,
                    {%else%}
                    Not Hidden,
                    {%endif%}

                    {%if decision.transition%}
                    Transition,
                    {%else%}
                    Not Transtion, 
                    {%endif%}

                    {%if decision.locked%}
                    Locked
                    {%else%}
                    Not Locked
                    {%endif%}
                </p>
            </div>
        </section>

        <section class="flex-0" onclick="decision_show(this)">
            <i class="fas fa-chevron-down fa-lg down-arrow"></i>
        </section>

    </section>
    <section class="row details" style="display: none">
         <!---add max value-->
            <label>Decision Sequence Number:</label>
            <input class="form-control" name= "sequence_number" min = "1" type= "number" onchange="decision_changed(this)">
        <hr>

        <label>Decision Description:</label>
        <textarea class="form-control" rows="3" name="dec_description" onchange="decision_changed(this)">{{ decision.decision_description }}</textarea>
        <hr>

        <label>Causes a transition?</label>
        {% if decision.transition %}
        <input type="checkbox" autocomplete="off" name="transition" onchange="decision_changed(this)" checked>
        {% else %}
        <input type="checkbox" autocomplete="off" name="transition" onchange="decision_changed(this)">
        {% endif %}
        <br>

         <!---should only display if "transition" is checked  @brian-->
        <label>Select Transition Location: or <a href = "/story/location/show"> Add New Location</a></label>
        <select type="text" class="form-control" autocomplete="off" name="transition_loc_id" onchange="decision_changed(this)">
                    {% for locations in location %}
                        <option>{{location.location_name}}</option>
                    {%endfor%}
                </select>
        <hr>

        <label>Can Occur only ONCE?</label>
        {% if decision.can_occur_once %}
        <input type="checkbox" autocomplete="off" name="can_occur_once" onchange="decision_changed(this)" checked>
        {% else %}
        <input type="checkbox" autocomplete="off" name="can_occur_once" onchange="decision_changed(this)">
        {% endif %}
        <hr>

        <label>Is Hidden?</label>
        {% if decision.hidden %}
        <input type="checkbox" autocomplete="off" name="hidden" onchange="decision_changed(this)" checked>
        {% else %}
        <input type="checkbox" autocomplete="off" name="hidden" onchange="decision_changed(this)">
        {% endif %}
        <br>
        <section class= "row flex-1">
            <div class = "col-sm-6">
            <!---should only display if "hid" is checked  @brian-->
            <label>Select Event to show decision: or <a href = "/story/event/show"> Add New Event</a></label>
             <select type="text" class="form-control" autocomplete="off" name="show_event_id" onchange="decision_changed(this)">
                {%for events in event%}
                <option>{{event.event_name}}</option>
                {%endfor%}
            </select>
            </div>
           <div class="col-sm-6">
             <!---should only display if "hid" is checked (and when object is selected?) @brian-->
         <label>Select Object to show decision: or <a href = "/story/object/show"> Add New Object</a></label>
            <select type="text" class="form-control" autocomplete="off" name="show_object_id" onchange="decision_changed(this)">
                {%for objects in object%}
                <option>{{object.obj_name}}</option>
                {%endfor%}
             </select>
            </div> 
        </section>
        <hr>
        
        <label>Is Locked?</label>
        {% if decision.locked %}
        <input type="checkbox" autocomplete="off" name="locked" onchange="decision_changed(this)" checked>
        {% else %}
        <input type="checkbox" autocomplete="off" name="locked" onchange="decision_changed(this)">
        {% endif %}
        <br>
<section class = "row flex-1">
        <div class = "col-sm-6">
         <!---should only display if "locked" is checked @brian-->
        <label>Select Object to unlock decision: or <a href = "/story/object/show"> Add New Object</a></label>
        <select type="text" class="form-control" autocomplete="off" name="unlock_event_id" onchange="decision_changed(this)">
                {%for objects in object%}
                <option>{{object.obj_name}}</option>
                {%endfor%}
        </select>

         <!---should only display if "locked" is checked (and when object is selected?) @brian-->
        <label>Description when locked (NOT by an event):</label>
        <textarea class="form-control" autocomplete="off" name="locked_descr" onchange="decision_changed(this)"></textarea>
        </div>
        <div class = "col-sm-6">
         <!---should only display if "locked" is checked  @brian-->
        <label>Select Event to unlock decision: or <a href = "/story/event/show"> Add New Event</a></label>
        <select type="text" class="form-control" autocomplete="off" name="unlock_event_id" onchange="decision_changed(this)">
                {%for events in event%}
                <option>{{event.event_name}}</option>
            {%endfor%}
         </select>

         <!---should only display if "locked" is checked (and when event is selected?) @brian--> 
        <label>Description when locked by event:</label>
        <textarea class="form-control" autocomplete="off" name="locked_descr" onchange="decision_changed(this)"></textarea>
        </div> 
    </section>
        <hr>

        <label>Description of decision aftermath:</label>
        <textarea name="aftermath_desc" class="form-control"  autocomplete="off" onchange="decision_changed(this)"></textarea>
        <hr> 
        <label>Does this decision trigger an event?</label>
        {% if decision.cause_event %}
        <input type="checkbox" autocomplete="off" onchange="decision_changed(this)" name="cause_event" checked>
        {% else %}
        <input type="checkbox" autocomplete="off" onchange="decision_changed(this)" name="cause_event">
        {% endif %}
        <br>

         <!---should only display if "triggered" is checked @brian-->
        <label>Select Event triggered by this decision: or <a href = "/story/event/show"> Add New Event</a></label>
        <select type="text" class="form-control" autocomplete="off" name="effect_event_id" onchange="decision_changed(this)">
                {%for events in event%}
                <option>{{event.event_name}}</option>
                {%endfor%}
         </select>
    </section>
</form>

{% endfor %}
<br>
<a href = "#add-btn"><button id = "bottom" class = "btn btn-light">Back to Top</button></a>
<a href = "/story/update"><button class = "btn btn-light">Back to Main Story Page</button></a>
{% endblock %}